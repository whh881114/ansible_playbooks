<html>
<head>
  <title>Evernote Export</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/602318 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="1449"/>
<h1>容器服务 如何选择 Containerd 和 Docker - 常见问题 - 文档中心 - 腾讯云</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>创建时间：</b></td><td><i>2021/5/5 19:01</i></td></tr>
<tr><td><b>来源：</b></td><td><a href="https://cloud.tencent.com/document/product/457/35747"><i>https://cloud.tencent.com/document/product/457/35747</i></a></td></tr>
</table>
</div>
<br/>

<div><span>
  <div style="--en-clipped-content:article; --en-clipped-source-url:https://cloud.tencent.com/document/product/457/35747; --en-clipped-source-title:容器服务 如何选择 Containerd 和 Docker - 常见问题 - 文档中心 - 腾讯云;">
<div><br/></div><div style="min-height: 3076px; font-size: 16px; display:block; min-width: 100%; position: relative;"> <div style="font-family:&quot;pingfang SC&quot;, &quot;helvetica neue&quot;, arial, &quot;hiragino sans gb&quot;, &quot;microsoft yahei ui&quot;, &quot;microsoft yahei&quot;, simsun, sans-serif;font-size:14px;-webkit-tap-highlight-color:transparent;"><div style="font-size:14px;line-height:1.5;color:rgb(51, 51, 51);-webkit-tap-highlight-color:transparent;background-color:rgb(255, 255, 255);"><div style="overflow-x:visible;background-color:#fff;"><div style="box-sizing:border-box;"><div><div style="box-sizing:border-box;"><div style="background-color:rgb(255, 255, 255);box-sizing:border-box;"><div style="box-sizing:border-box;"><div style="box-sizing:border-box;"><div><div><div><div><div style="text-size-adjust:none;line-height:1.8;overflow-wrap:break-word;list-style:outside;color:rgb(51, 51, 51);"><span style="line-height:1.8;list-style:outside;color:rgb(51, 51, 51);display:table;"></span>
				<h3 style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:17px;margin-bottom:4px;font-weight:700;color:rgb(51, 51, 51);font-size:16px;">如何选择运行时组件？</h3><p style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;margin-bottom:10px;">容器运行时（Container Runtime）是 Kubernetes（k8s） 最重要的组件之一，负责管理镜像和容器的生命周期。Kubelet 通过 <code style="box-sizing:border-box;list-style:inherit;margin:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;padding:0px 3px;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>Container Runtime Interface (CRI)<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code> 与容器运行时交互，以管理镜像和容器。</p>
<p style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;margin-bottom:10px;">TKE 支持用户选择 containerd 和 docker 作为运行时组件：</p>
<ul style="margin:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;margin-bottom:24px;padding:0px 0px 0px 17px;">
<li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">Containerd 调用链更短，组件更少，更稳定，占用节点资源更少。 建议选择 containerd。</li>
<li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">当您遇到以下情况时，请选择 docker 作为运行时组件：<ul style="margin:0px;box-sizing:border-box;list-style:inherit;list-style-type:circle;padding:0px 0px 0px 17px;margin-top:0px;margin-bottom:0px;">
<li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">如需使用 docker in docker。</li>
<li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">如需在 TKE 节点使用 docker build/push/save/load 等命令。</li>
<li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">如需调用 docker API。</li>
<li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">如需 docker compose 或 docker swarm。</li>
</ul>
</li>
</ul>
<h3 style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:17px;margin-bottom:4px;font-weight:700;color:rgb(51, 51, 51);font-size:16px;">Containerd 和 Docker 组件常用命令是什么？</h3><p style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;margin-bottom:10px;">Containerd 不支持 docker API 和 docker CLI，但是可以通过 cri-tool 命令实现类似的功能。</p>
<div style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;max-width:100%;overflow-x:auto;margin-bottom:24px;padding-bottom:5px;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;width:100%;border-top:1px solid rgb(217, 217, 217);border-right:1px solid rgb(217, 217, 217);border-left:1px solid rgb(217, 217, 217);border-image:initial;border-bottom:none;line-height:1.5;margin-bottom:0px;">
<thead style="box-sizing:border-box;list-style:inherit;">
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">镜像相关功能</th>
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">Docker</th>
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">Containerd</th>
</tr>
</thead>
<tbody style="box-sizing:border-box;list-style:inherit;"><tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">显示本地镜像列表</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker images</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl images</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">下载镜像</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker pull</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl pull</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">上传镜像</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker push</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">无</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">删除本地镜像</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker rmi</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl rmi</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">查看镜像详情</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker inspect IMAGE-ID</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl inspect IMAGE-ID</td>
</tr>
</tbody></table></div>
<div style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;max-width:100%;overflow-x:auto;margin-bottom:24px;padding-bottom:5px;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;width:100%;border-top:1px solid rgb(217, 217, 217);border-right:1px solid rgb(217, 217, 217);border-left:1px solid rgb(217, 217, 217);border-image:initial;border-bottom:none;line-height:1.5;margin-bottom:0px;">
<thead style="box-sizing:border-box;list-style:inherit;">
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">容器相关功能</th>
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">Docker</th>
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">Containerd</th>
</tr>
</thead>
<tbody style="box-sizing:border-box;list-style:inherit;"><tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">显示容器列表</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker ps</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl ps</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">创建容器</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker create</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl create</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">启动容器</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker start</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl start</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">停止容器</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker stop</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl stop</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">删除容器</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker rm</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl rm</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">查看容器详情</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker inspect</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl inspect</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">attach</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker attach</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl attach</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">exec</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker exec</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl exec</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">logs</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker logs</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl logs</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">stats</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">docker stats</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl stats</td>
</tr>
</tbody></table></div>
<div style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;max-width:100%;overflow-x:auto;margin-bottom:24px;padding-bottom:5px;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;width:100%;border-top:1px solid rgb(217, 217, 217);border-right:1px solid rgb(217, 217, 217);border-left:1px solid rgb(217, 217, 217);border-image:initial;border-bottom:none;line-height:1.5;margin-bottom:0px;">
<thead style="box-sizing:border-box;list-style:inherit;">
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">POD 相关功能</th>
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">Docker</th>
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">Containerd</th>
</tr>
</thead>
<tbody style="box-sizing:border-box;list-style:inherit;"><tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">显示 POD 列表</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">无</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl pods</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">查看 POD 详情</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">无</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl inspectp</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">运行 POD</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">无</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl runp</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">停止 POD</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">无</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">crictl stopp</td>
</tr>
</tbody></table></div>
<h3 style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:17px;margin-bottom:4px;font-weight:700;color:rgb(51, 51, 51);font-size:16px;">调用链区别有哪些？</h3><ul style="margin:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;margin-bottom:24px;padding:0px 0px 0px 17px;">
<li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">Docker 作为 k8s 容器运行时，调用关系如下：<br style="box-sizing:border-box;list-style:inherit;"/><code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>kubelet --&gt; docker shim （在 kubelet 进程中） --&gt; dockerd --&gt; containerd<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code></li>
<li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">Containerd 作为 k8s 容器运行时，调用关系如下：<br style="box-sizing:border-box;list-style:inherit;"/><code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>kubelet --&gt; cri plugin（在 containerd 进程中） --&gt; containerd<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code></li>
</ul>
<p style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;margin-bottom:10px;">其中 dockerd 虽增加了 swarm cluster、 docker build 、 docker API 等功能，但也会引入一些 bug，而与 containerd 相比，多了一层调用。</p>
<h2 style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;color:rgb(51, 51, 51);line-height:20px;font-size:20px;margin-top:36px;margin-bottom:16px;font-weight:700;">Stream 服务</h2>
						<blockquote style="box-sizing:border-box;list-style:inherit;margin:20px 0px;color:rgb(21, 21, 21);border-left:4px solid rgb(221, 221, 221);background:rgb(239, 249, 255);background-color:rgb(255, 255, 255);position:relative;line-height:24px;margin-top:12px;margin-bottom:25px;border-radius:2px;border:1px solid rgb(201, 227, 242);padding:10px 10px 10px 40px;"><span style="list-style:inherit;color:rgb(21, 21, 21);line-height:24px;position:absolute;left:-1px;top:-1px;bottom:-1px;width:2px;height:calc(100% + 2px);background-color:rgb(0, 164, 255);"></span>
							<div style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;font-size:14px;line-height:28px;color:rgb(51, 51, 51);margin-top:0px;">
								<i style="box-sizing:border-box;list-style:inherit;width:16px;height:16px;position:absolute;left:16px;top:15px;background-image:url(https://cloudcache.tencent-cloud.com/open_proj/proj_qcloud_v2/gateway/documentation/documentation-v4/css/sprite/pandect-202012171130.svg);background-position:10.7% 99.8%;background-size:3312.5% 3175%;background-repeat:no-repeat;font-style:italic;font-weight:inherit;"></i>说明：
							</div>
               <p style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;margin-bottom:0px;">Kubectl exec/logs 等命令需要在 apiserver 跟容器运行时之间建立流转发通道。</p>

						</blockquote>
						<h3 style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:17px;margin-bottom:4px;font-weight:700;color:rgb(51, 51, 51);font-size:16px;">如何在 Containerd 中使用并配置 Stream 服务？</h3><p style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;margin-bottom:10px;">Docker API 本身提供 stream 服务，kubelet 内部的 docker-shim 会通过 docker API 做流转发。<br style="box-sizing:border-box;list-style:inherit;"/>Containerd 的 stream 服务需要单独配置：</p>
<div style="margin:0px;padding:0px;list-style:inherit;box-sizing:border-box;margin-bottom:24px;"><span style="list-style:inherit;padding:0px;margin:0px;box-sizing:border-box;"></span>
					<div style="margin:0px;padding:0px;list-style:inherit;box-sizing:border-box;background-color:rgb(80, 85, 107);border-radius:2px;margin-bottom:0px;"><span style="list-style:inherit;padding:0px;margin:0px;box-sizing:border-box;"></span>
						
						<div style="margin:0px;list-style:inherit;box-sizing:border-box;padding:16px 40px 0px 20px;position:relative;border:none;"><span style="list-style:inherit;padding:0px;margin:0px;box-sizing:border-box;"></span>
							<div style="margin:0px;padding:0px;list-style:inherit;box-sizing:border-box;position:absolute;right:12px;top:12px;z-index:2;"><span style="list-style:inherit;padding:0px;margin:0px;box-sizing:border-box;"></span>
								<a href="#" style="padding:0px;margin:0px;list-style:inherit;box-sizing:border-box;text-decoration:none;color:rgb(0, 164, 255);display:inline-block;vertical-align:middle;background-repeat:no-repeat;width:16px;height:16px;background-image:url(https://cloudcache.tencent-cloud.com/open_proj/proj_qcloud_v2/platform/documents/css/sprite/documents-202104131641.svg);background-size:1687.5% 1618.75%;background-position:0.39% 87.24%;"><span style="list-style:inherit;color:rgb(0, 164, 255);padding:0px;margin:0px;box-sizing:border-box;"></span><span style="list-style:inherit;color:rgb(0, 164, 255);padding:0px;margin:0px;box-sizing:border-box;"></span></a>
								
								
							<span style="list-style:inherit;padding:0px;margin:0px;box-sizing:border-box;"></span></div>
						<pre style="margin:0px;list-style:inherit;box-sizing:border-box;margin-top:0px;margin-bottom:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;background-color:rgb(80, 85, 107);color:rgb(255, 255, 255);overflow-x:auto;line-height:24px;padding:0px 0px 16px;overflow-y:hidden;"><span style="list-style:inherit;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;color:rgb(255, 255, 255);line-height:24px;padding:0px;margin:0px;box-sizing:border-box;"></span><code style="box-sizing:border-box;list-style:inherit;padding:0px;border-radius:3px;font-size:1em;line-height:24px;color:rgb(255, 255, 255);font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;margin:0px;background-color:transparent;"><span style="list-style:inherit;font-size:1em;line-height:24px;color:rgb(255, 255, 255);font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>[<span style="box-sizing:border-box;list-style:inherit;color:rgb(204, 153, 205);">plugins.cri</span>]
 stream_server_address = <span style="box-sizing:border-box;list-style:inherit;color:rgb(134, 217, 158);">&quot;127.0.0.1&quot;</span>
 stream_server_port = <span style="box-sizing:border-box;list-style:inherit;color:rgb(134, 217, 158);">&quot;0&quot;</span>
 enable_tls_streaming = <span style="box-sizing:border-box;list-style:inherit;color:rgb(204, 153, 205);">false</span><span style="list-style:inherit;font-size:1em;line-height:24px;color:rgb(255, 255, 255);font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code><span style="list-style:inherit;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;color:rgb(255, 255, 255);line-height:24px;padding:0px;margin:0px;box-sizing:border-box;"></span></pre><span style="list-style:inherit;padding:0px;margin:0px;box-sizing:border-box;"></span></div>
					<span style="list-style:inherit;padding:0px;margin:0px;box-sizing:border-box;"></span></div>
				<span style="list-style:inherit;padding:0px;margin:0px;box-sizing:border-box;"></span></div>

<h3 style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:17px;margin-bottom:4px;font-weight:700;color:rgb(51, 51, 51);font-size:16px;">k8s 1.11 前后版本配置区别是什么？</h3><p style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;margin-bottom:10px;">Containerd 的 stream 服务在 k8s 不同版本运行时场景下配置不同。</p>
<ul style="margin:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;margin-bottom:24px;padding:0px 0px 0px 17px;">
<li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">在 k8s 1.11 之前：<br style="box-sizing:border-box;list-style:inherit;"/>Kubelet 不会做 stream proxy，只会做重定向。即 Kubelet 会将 containerd 暴露的 stream server 地址发送给 apiserver，并让 apiserver 直接访问 containerd 的 stream 服务。此时，您需要给 stream 服务转发器认证，用于安全防护。</li>
<li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">在 k8s 1.11 之后：<br style="box-sizing:border-box;list-style:inherit;"/>k8s1.11 引入了 <a href="https://github.com/kubernetes/kubernetes/pull/64006" style="box-sizing:border-box;list-style:inherit;text-decoration:none;color:rgb(0, 164, 255);" target="_blank">kubelet stream proxy</a>， 使 containerd stream 服务只需要监听本地地址即可。</li>
</ul>
<h2 style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;color:rgb(51, 51, 51);line-height:20px;font-size:20px;margin-top:36px;margin-bottom:16px;font-weight:700;">其他差异</h2><h3 style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:17px;margin-bottom:4px;font-weight:700;color:rgb(51, 51, 51);font-size:16px;">容器日志及相关参数</h3><div style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;max-width:100%;overflow-x:auto;margin-bottom:24px;padding-bottom:5px;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;width:100%;border-top:1px solid rgb(217, 217, 217);border-right:1px solid rgb(217, 217, 217);border-left:1px solid rgb(217, 217, 217);border-image:initial;border-bottom:none;line-height:1.5;margin-bottom:0px;">
    <tbody style="box-sizing:border-box;list-style:inherit;"><tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
    <th style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;width:10%;">对比项</th>
    <th style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">Docker</th>
    <th style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">Containerd</th>
    </tr>
    <tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
        <td style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">存储路径</td>
        <td style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">
    如果 Docker 作为 k8s 容器运行时，容器日志的落盘将由 docker 来完成，保存在类似<code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>/var/lib/docker/containers/$CONTAINERID<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code> 目录下。Kubelet 会在 <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>/var/log/pods<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code> 和 <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>/var/log/containers<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code> 下面建立软链接，指向 <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>/var/lib/docker/containers/$CONTAINERID<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code> 该目录下的容器日志文件。
        </td>
        <td style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">
        如果 Containerd 作为 k8s 容器运行时， 容器日志的落盘由 Kubelet 来完成，保存至 <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>/var/log/pods/$CONTAINER_NAME<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code> 目录下，同时在 <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>/var/log/containers<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code> 目录下创建软链接，指向日志文件。            
        </td>
    </tr>
    <tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
        <td style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">配置参数 </td>
        <td style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">
        在 docker 配置文件中指定：
        <br style="box-sizing:border-box;list-style:inherit;"/>    <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>&quot;log-driver&quot;: &quot;json-file&quot;,<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code> 
        <br style="box-sizing:border-box;list-style:inherit;"/>    <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>&quot;log-opts&quot;: {&quot;max-size&quot;: &quot;100m&quot;,&quot;max-file&quot;: &quot;5&quot;}<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code>
        </td>
        <td style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">
        <ul style="margin:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;margin-bottom:24px;padding:0px 0px 0px 17px;">
        <li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">
        方法一：在 kubelet 参数中指定： <br style="box-sizing:border-box;list-style:inherit;"/> <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>--container-log-max-files=5<br style="box-sizing:border-box;list-style:inherit;"/> --container-log-max-size=&quot;100Mi&quot;<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code> <br style="box-sizing:border-box;list-style:inherit;"/>
        </li>
        <li style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;">方法二：在 KubeletConfiguration 中指定：<br style="box-sizing:border-box;list-style:inherit;"/>    <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>&quot;containerLogMaxSize&quot;: &quot;100Mi&quot;,<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code><br style="box-sizing:border-box;list-style:inherit;"/>    <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>&quot;containerLogMaxFiles&quot;: 5, <span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code>
        </li>
        </ul>
        </td>
    </tr>
    <tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
    <td style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">把容器日志保存到数据盘</td>
    <td style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">把数据盘挂载到 “data-root”（缺省是 <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>/var/lib/docker<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code>）即可。</td>
    <td style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">创建一个软链接 <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>/var/log/pods<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code> 指向数据盘挂载点下的某个目录。 <br style="box-sizing:border-box;list-style:inherit;"/>在 TKE 中选择“将容器和镜像存储在数据盘”，会自动创建软链接 <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>/var/log/pods<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code>。
    </td>
    </tr>
</tbody></table></div>


<h3 style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;margin-top:17px;margin-bottom:4px;font-weight:700;color:rgb(51, 51, 51);font-size:16px;">CNI 网络</h3><div style="margin:0px;padding:0px;box-sizing:border-box;list-style:inherit;max-width:100%;overflow-x:auto;margin-bottom:24px;padding-bottom:5px;"><table style="font-size:inherit;font-weight:inherit;font-style:inherit;font-variant:inherit;border-collapse:collapse;border-spacing:0px;box-sizing:border-box;list-style:inherit;margin-top:0px;width:100%;border-top:1px solid rgb(217, 217, 217);border-right:1px solid rgb(217, 217, 217);border-left:1px solid rgb(217, 217, 217);border-image:initial;border-bottom:none;line-height:1.5;margin-bottom:0px;">
<thead style="box-sizing:border-box;list-style:inherit;">
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">对比项</th>
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">Docker</th>
<th align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;background-color:rgb(245, 247, 250);color:rgb(0, 0, 0);font-weight:400;word-break:keep-all;">Containerd</th>
</tr>
</thead>
<tbody style="box-sizing:border-box;list-style:inherit;"><tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">谁负责调用 CNI</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">Kubelet 内部的 docker-shim</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">Containerd 内置的 cri-plugin（containerd 1.1 以后）</td>
</tr>
<tr style="box-sizing:border-box;list-style:inherit;background-color:rgb(255, 255, 255);">
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">如何配置 CNI</td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">Kubelet 参数 <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>--cni-bin-dir<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code> 和 <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>--cni-conf-dir<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code></td>
<td align="left" style="margin:0px;box-sizing:border-box;list-style:inherit;border:1px solid rgb(225, 230, 240);overflow-wrap:break-word;text-align:left;padding:8px 13px;color:rgb(102, 102, 102);">Containerd 配置文件（toml）：<br style="box-sizing:border-box;list-style:inherit;"/> <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>[plugins.cri.cni]<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code><br style="box-sizing:border-box;list-style:inherit;"/>    <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>bin_dir = &quot;/opt/cni/bin&quot;<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code><br style="box-sizing:border-box;list-style:inherit;"/>    <code style="box-sizing:border-box;list-style:inherit;margin:0px;padding:0px;background-color:rgba(0, 0, 0, 0.04);border-radius:3px;font-size:1em;line-height:24px;font-family:Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, &quot;Microsoft Yahei&quot;, monospace;"><span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span>conf_dir = &quot;/etc/cni/net.d&quot;<span style="list-style:inherit;font-size:1em;line-height:24px;font-family:Consolas, Liberation Mono, Menlo, Courier, Microsoft Yahei, monospace;letter-spacing:-0.2em;"></span></code></td>
</tr>
</tbody></table></div>

				
			<span style="line-height:1.8;list-style:outside;color:rgb(51, 51, 51);display:table;clear:both;"></span></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div>
</div>
</span>
</div></body></html> 